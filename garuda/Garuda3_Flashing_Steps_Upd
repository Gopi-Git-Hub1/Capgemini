Garuda3 Firmware Flashing Steps:-
--------------------------------
Step 1: Copy the firmware file i.e. "garuda3" in the following path.(Delete or keep it another location, which is already present)
	path->Garuda3/meta-garuda3/recipes-garuda3
	
Step 2:Open terminal and run following commands step by step:
	1)cd Garuda3/poky
	2)source oe-init-build-env build-microchip
	3)LC_ALL=en_US.utf8 bitbake -c cleanall garuda3
	4)LC_ALL=en_US.utf8 bitbake garuda3   OR LC_ALL=en_US.utf8 bitbake core-image-minimal
	5)LC_ALL=en_US.utf8 bitbake -C compile virtual/kernel (To update linux drivers)
	 ##Path of mcan drivers:---> /home/mahantagouda/G3D/poky/build-microchip/tmp/work-shared/sama5d27-som1-ek-sd/kernel-source/drivers/net/can/m_can ##
Step 3:Open another terminal and run the following commands step by step:
	1)cd fit/dt-overlay-at91
	2)./cp_image.sh
	3)export CROSS_COMPILE=arm-linux-gnueabi-
        4)make ARCH=arm sama5d2_garuda3.itb
        
step 4:Open another terminal and run the following commands step by step:
	1)cd garuda3_image/image
	2)./create-nor_emmc-image.sh
	3) cd emmcmntp2
	4)sudo rm -rf *
	5)Go to the step 2, terminal and run the following command:
		5.1)cd tmp/deploy/images/sama5d27-som1-ek-sd/
		5.2)copy "core-image-minimal-sama5d27-som1-ek-sd-20240510111850.rootfs.tar.gz" from the list of present working directory.
	6)Then come to the step 4, terminal and run the following command:
		6.1)sudo tar -xvf ~/Garuda3/poky/build-microchip/tmp/deploy/images/sama5d27-som1-ek-sd/core-image-minimal-sama5d27-som1-ek-sd-20240911072411.rootfs.tar.gz
		6.2)sync
		6.3)Go to the image folder of step 4:
			---> cd ../..
		6.4)./cp_to_flash.sh
		6.5)./unmount_flash.sh
		
Step 5:Open another terminal and run the following commands: 
	1)cd garuda3_image/SAMBA/samba/sam-ba_v3.7-linux_x86_64
	2)./write_linux.sh 
	(Note: if ./write_linux.sh is not working then in minicom reboot device press any key to enter uboot and give this cmd > mmc write 0x24000000 0 0x40000 
          and then close minicom and open again minicom and then run ./write_linux.sh)	
 
 Step 6:Open the minicom in another terminal by running the command---->   "sudo minicom -D /dev/ttyUSB0"    
 	1)Go to step 5, terminal i.e. cd garuda3_image/SAMBA/samba/sam-ba_v3.7-linux_x86_64  and run ./reset.sh   
 	(After running this command, It should change from ttyUSB0 to "ttyACM0", If not changes to ttyACM0, Do hardware reset and again run "./reset.sh" )
 	2)Once it changed to "ttyACM0", In step 6 terminal, uboot>....................... comes. There paste the following commands one after one
	
	Command 1:setenv bootargs console=ttyS0,115200 earlycon earlyprintk=serial,ttyS0,ignore_loglevel root=/dev/mmcblk0p2 memtest=0 rootfstype=ext4 rw rootwait
	Command 2:ext4load mmc 0:2 0x24000000 boot/sama5d2_garuda3.itb; bootm 0x24000000#kernel_dtb	
	
	ip link set can0 up type can bitrate 500000 dbitrate 2000000 sample-point 0.792 dsample-point 0.833 fd on fd-non-iso off
Step 7:Login as "root" and Then "run-g3d.sh"

NOTE:Check hid script-> vi /etc/init.d/hid.sh
     Check run-g3d.sh-> vi /usr/bin/run-g3d.sh
      
      To verify that the changes are reflected or not for CAN-FD.If you make changes, reboot once. 
    
    =>update-rc.d hid.sh defaults
    ________________________________________________________
    DB-9 Connector:-  CAN-H=>Pin_7
		      CAN-L=>Pin_2
			  
	DB-25 Connector:-  Channel_0:- CAN-H=>Pin_3
			   	       CAN-L=>Pin_4
   _________________________________________________________
    
    
    ip link set can0 up type can bitrate 500000 dbitrate 2000000 sample-point 0.792 dsample-point 0.833 fd on fd-non-iso off
    
    
    
    
    [12:05] Bharani, Akkireddy
/usr/sbin/g3d &
 
[12:07] Bharani, Akkireddy
setenv bootcmd 'ext4load mmc 0:2 0x24000000 boot/sama5d2_garuda3.itb; bootm 0x24000000#kernel_dtb' && saveenv
 
[12:07] Bharani, Akkireddy
run above command in uboot after saving bootargs
 
 
 [12:53] Bharani, Akkireddy
sudo ./sam-ba -p serial -b sama5d2-g3v1 -a bootconfig -c readcfg:fuse

Opening serial port 'ttyACM0'

Connection opened.

Executing command 'readcfg:fuse'

FUSE=0x00000000 / QSPI0_IOSET1,QSPI1_IOSET1,SPI0_IOSET1,SPI1_IOSET1,NFC_IOSET1,SDMMC0,SDMMC1,UART1_IOSET1,JTAG_IOSET1

Connection closed.
 
[12:53] Bharani, Akkireddy
sudo ./sam-ba -p serial -b sama5d2-g3v1 -a bootconfig -c writecfg:fuse:0x00061FF7

Opening serial port 'ttyACM0'

Connection opened.

Executing command 'writecfg:fuse:0x00061FF7'

Setting FUSE to 0x00061ff7 (QSPI0_DISABLED,QSPI1_IOSET2,SPI0_DISABLED,SPI1_DISABLED,NFC_DISABLED,SDMMC0_DISABLED,SDMMC1_DISABLED,UART0_IOSET1,JTAG_IOSET3,EXT_MEM_BOOT)

Connection closed.
 
[12:54] Bharani, Akkireddy
sudo ./sam-ba -p serial -b sama5d2-g3v1 -a bootconfig -c readcfg:fuse

Opening serial port 'ttyACM0'

Connection opened.

Executing command 'readcfg:fuse'

FUSE=0x00061ff7 / QSPI0_DISABLED,QSPI1_IOSET2,SPI0_DISABLED,SPI1_DISABLED,NFC_DISABLED,SDMMC0_DISABLED,SDMMC1_DISABLED,UART0_IOSET1,JTAG_IOSET3,EXT_MEM_BOOT

Connection closed.
 

